## Installing piring
# Hardware: Raspberry Pi with 3.5" touchscreen (ADS7846) and relay board.

# Put RaspberryOS on an SD card: https://www.raspberrypi.com/software/operating-systems/

# Boot up, choose username pi and initialize:
sudo -i
raspi-config
# Set the desired screensaver timeout, and no lock!
# Make sure ssh access is workable in case the screen drivers have problems!

# Refresh the repo info, upgrade and install prerequisite packages and git
apt update
apt install sox python3-pygame tmux git
apt full-upgrade

# Allow user to run raspi-gpio binary:
chmod u+s /usr/bin/raspi-gpio

# Install screen driver
git clone https://github.com/goodtft/LCD-show.git
chmod -R 755 LCD-show
cd LCD-show
./LCD35-show  # Leads to reboot

# Tweak firmware:
echo ads7846 >>/etc/modules
echo -e "# quicker sound\nhdmi_ignore_edid_audio=1\ndisable_touchscreen=0\nenable_dpi_lcd=1" >>/boot/firmware/usercfg.txt

# Allow autostart desktop through Lightdm:
echo -e "[Seat:*]\nautologin-user=pi\nautologin-session=mate" >\
		/etc/lightdm/lightdm.conf
gpasswd -a pi nopasswdlogin

# Allow audio use
gpasswd -a pi audio

# Clone this repo as user pi:
sudo -u pi bash
cd
mkdir git
cd git
git clone https://gitlab.com/pepa65/piring
cd piring

# Set autostart with crontab @reboot
echo "@reboot  $HOME/git/piring/atreboot"

